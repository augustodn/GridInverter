Version 4
SHEET 1 1004 1124
WIRE -2016 -432 -2048 -432
WIRE -2048 -400 -2048 -432
WIRE -2048 -272 -2048 -320
WIRE -1808 -208 -1808 -256
WIRE -1568 -160 -1616 -160
WIRE -1968 -96 -2032 -96
WIRE -1488 -80 -1616 -80
WIRE -1968 -64 -2032 -64
WIRE -1216 -64 -1344 -64
WIRE -1168 -64 -1216 -64
WIRE -1040 -64 -1088 -64
WIRE -928 -64 -1040 -64
WIRE -832 -64 -848 -64
WIRE -800 -64 -832 -64
WIRE -576 -64 -736 -64
WIRE -512 -64 -576 -64
WIRE -1568 -32 -1568 -160
WIRE -1568 -32 -1616 -32
WIRE -736 -16 -736 -64
WIRE -1344 0 -1344 -64
WIRE -1216 0 -1216 -64
WIRE -1040 0 -1040 -64
WIRE -832 0 -832 -64
WIRE -576 0 -576 -64
WIRE -1872 80 -1872 64
WIRE -896 80 -928 80
WIRE -880 80 -896 80
WIRE -2032 96 -2080 96
WIRE -832 96 -832 64
WIRE -832 128 -832 96
WIRE -736 128 -736 48
WIRE -576 128 -576 80
WIRE -2032 144 -2032 96
WIRE -1808 144 -1808 80
WIRE -1344 144 -1344 80
WIRE -912 144 -960 144
WIRE -896 144 -912 144
WIRE -1712 160 -1760 160
WIRE -1568 160 -1568 -32
WIRE -1568 160 -1712 160
WIRE -1872 192 -1872 80
WIRE -1872 192 -1920 192
WIRE -1760 192 -1760 160
WIRE -1760 192 -1872 192
WIRE -960 192 -960 144
WIRE -1568 240 -1568 160
WIRE -1872 256 -1920 256
WIRE -1712 256 -1712 240
WIRE -1712 256 -1872 256
WIRE -960 272 -960 256
WIRE -1712 288 -1712 256
WIRE -960 304 -960 272
WIRE -2032 336 -2032 304
WIRE -1712 400 -1712 368
WIRE -1568 400 -1568 304
FLAG -1344 144 0
FLAG -832 128 0
FLAG -736 128 0
FLAG -896 80 in3
FLAG -912 144 in3
FLAG -960 304 0
FLAG -576 128 0
FLAG -1808 144 0
FLAG -512 -64 Vo
IOPIN -512 -64 Out
FLAG -2048 -272 0
FLAG -2016 -432 5V
IOPIN -2016 -432 Out
FLAG -1808 -256 5V
IOPIN -1808 -256 In
FLAG -1488 -80 Imon
IOPIN -1488 -80 Out
FLAG -1216 0 V+
IOPIN -1216 0 Out
FLAG -1040 0 V-
IOPIN -1040 0 Out
FLAG -2032 -96 V-
IOPIN -2032 -96 In
FLAG -2032 -64 V+
IOPIN -2032 -64 In
FLAG -2032 336 0
FLAG -2080 96 5V
IOPIN -2080 96 In
FLAG -1712 400 0
FLAG -1568 400 0
SYMBOL voltage -1344 -16 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 -41 36 Right 2
WINDOW 3 -45 68 Right 2
SYMATTR InstName V1
SYMATTR Value 8
SYMBOL ind -944 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 50µ
SYMBOL cap -752 -16 R0
SYMATTR InstName C2
SYMATTR Value 470µ
SYMBOL nmos -880 0 R0
WINDOW 0 -31 18 Left 2
WINDOW 3 -89 49 Left 2
SYMATTR InstName M5
SYMATTR Value IRFH5302
SYMBOL schottky -800 -48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value MBRS1100
SYMBOL voltage -960 176 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -165 163 Left 2
SYMATTR Value PULSE(0 15V 0 1n 1n 110u 160u)
SYMATTR InstName V4
SYMBOL res -592 -16 R0
SYMATTR InstName R1
SYMATTR Value 2
SYMBOL Opamps\\LT1990 -1792 -80 R0
SYMATTR InstName U1
SYMBOL res -1184 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value .01
SYMBOL voltage -2048 -416 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL References\\LT6650 -2032 224 R0
SYMATTR InstName U2
SYMBOL cap -1888 192 R0
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL res -1728 144 R0
SYMATTR InstName R3
SYMATTR Value 15k
SYMBOL res -1728 272 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL polcap -1584 240 R0
SYMATTR InstName C4
SYMATTR Value 10µ
TEXT -840 200 Left 2 !.tran 5 startup
TEXT -1936 -472 Left 2 ;LT1990 is an isolated Op Amp ideal for current sensing on high side \nRight now is configurated to have x10 Gain. Imon [V] = Vin * 10. (40A max) \nLT6650 is a programmable voltage reference. \nRight now is programmed to be 1V, so this is the offset for LT1990 output.\nMaybe the idea is sense current and if voltage is less than 1V, due to current \ngoing to solar panel, disconnect the circuit.
